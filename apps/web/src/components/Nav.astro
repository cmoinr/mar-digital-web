---
// Nav.astro - Navbar moderna responsive con efecto glass & menú móvil sin JS extra
// Definición de enlaces principales
const links = [
  { href: '/', label: 'Inicio' },
  { href: '/servicios', label: 'Servicios' },
  { href: '/optimizacion', label: 'Optimiza tu negocio' },
  { href: '/about', label: 'Nosotros' },
  { href: '/blog', label: 'Blog' }
];

const pathname = Astro.url.pathname.replace(/\/$/, '') || '/';
---
<nav class="fixed top-0 inset-x-0 z-50" role="navigation" aria-label="Principal">
  <div class="mx-auto max-w-7xl px-4 md:px-6">
    <div class="nav-glass mt-4 flex items-center justify-between rounded-2xl py-3 pl-5 pr-4 relative overflow-hidden">
      <!-- Animated gradient shimmer layer -->
      <div class="pointer-events-none absolute inset-0 opacity-[0.65] mix-blend-overlay nav-gradient"></div>
      <!-- Liquid blobs -->
      <div class="pointer-events-none absolute -top-12 -left-10 w-52 h-52 rounded-full bg-gradient-to-br from-brand/40 via-cyan-400/30 to-brand-dark/40 blur-3xl animate-blob-slow"></div>
      <div class="pointer-events-none absolute -bottom-14 -right-8 w-60 h-60 rounded-full bg-gradient-to-tr from-cyan-400/35 via-brand/30 to-brand-dark/40 blur-3xl animate-blob-slower"></div>
      <!-- Inner subtle highlight -->
      <div class="pointer-events-none absolute inset-0 rounded-2xl ring-1 ring-white/50"></div>
      <!-- Brand -->
      <a href="/" class="relative font-extrabold tracking-tight text-lg flex items-center gap-2 text-gray-900 group">
        <span class="relative bg-clip-text text-transparent bg-[linear-gradient(100deg,#fff,#e2ecff_35%,#bcd7ff_55%,#ffffff_75%)] animate-title-shimmer bg-[length:220%_100%]">Mar Digital</span>
        <span class="absolute -bottom-1 left-0 h-px w-0 bg-gradient-to-r from-brand via-cyan-400 to-brand-dark transition-all duration-500 group-hover:w-full"></span>
      </a>

      <!-- Desktop Nav -->
      <ul class="hidden md:flex items-center gap-1 font-medium text-sm relative">
        {links.map(l => {
          const active = l.href === pathname || (l.href !== '/' && pathname.startsWith(l.href));
          return (
            <li>
              <a href={l.href} class={`nav-link group relative inline-flex items-center gap-1 px-3 py-2 rounded-full transition font-medium
                ${active ? 'is-active' : ''}
              `}>
                <span class="relative z-10">{l.label}</span>
                <span class="hover-glow"></span>
              </a>
            </li>
          );
        })}
      </ul>

      <!-- CTA / Actions -->
      <div class="hidden md:flex items-center gap-3 relative">
        <a href="/contacto" class="cta-btn">
          <span>Contacto</span>
        </a>
      </div>

      <!-- Mobile Menu Toggle -->
      <details class="md:hidden relative group">
        <summary class="list-none flex items-center justify-center w-9 h-9 rounded-full border border-white/40 bg-white/70 backdrop-blur-xl cursor-pointer shadow-sm hover:shadow-md transition focus:outline-none focus-visible:ring-2 focus-visible:ring-brand/40">
          <div class="relative w-5 h-4">
            <span class="absolute inset-x-0 top-0 h-0.5 bg-gray-800 rounded transition origin-left group-open:rotate-45 group-open:top-1.5"></span>
            <span class="absolute inset-x-0 top-1/2 -translate-y-1/2 h-0.5 bg-gray-800 rounded transition group-open:opacity-0"></span>
            <span class="absolute inset-x-0 bottom-0 h-0.5 bg-gray-800 rounded transition origin-left group-open:-rotate-45 group-open:bottom-1.5"></span>
          </div>
        </summary>
        <div class="absolute right-0 mt-4 w-64 origin-top shadow-xl rounded-2xl border border-white/50 bg-white/90 backdrop-blur-xl p-4 flex flex-col gap-2 animate-scale-in overflow-hidden">
          <div class="absolute inset-0 pointer-events-none bg-[radial-gradient(circle_at_20%_25%,rgba(226,236,255,.9),transparent_55%),radial-gradient(circle_at_85%_70%,rgba(46,106,255,.25),transparent_60%)]" />
          {links.map(l => {
            const active = l.href === pathname || (l.href !== '/' && pathname.startsWith(l.href));
            return (
              <a href={l.href} class={`relative px-3 py-2 rounded-lg text-sm font-medium transition
                ${active ? 'bg-brand/15 text-brand-dark shadow-inner' : 'text-gray-700 hover:bg-brand/10 hover:text-brand-dark'}
              `}>{l.label}</a>
            );
          })}
          <a href="/contacto" class="relative mt-2 inline-flex justify-center rounded-full bg-gradient-to-r from-brand via-cyan-400 to-brand-dark text-white text-sm font-semibold px-5 py-2 shadow hover:brightness-110 transition">Contacto</a>
        </div>
      </details>
    </div>
  </div>
</nav>

<!-- Spacer to avoid content hidden under fixed navbar -->
<div class="h-28"></div>

<style lang="css">
  /* Liquid glass + animated gradient & blobs */
  .nav-glass {
    background: linear-gradient(135deg, rgba(255,255,255,0.78), rgba(255,255,255,0.55) 30%, rgba(255,255,255,0.35) 65%);
    backdrop-filter: blur(28px) saturate(140%);
    -webkit-backdrop-filter: blur(28px) saturate(140%);
    border: 1px solid rgba(255,255,255,0.55);
  }
  .nav-glass::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: 1px;
    background: linear-gradient(120deg, rgba(255,255,255,0.7), rgba(255,255,255,0) 30%, rgba(14,165,233,0.25) 55%, rgba(46,106,255,.35) 75%, rgba(255,255,255,0.6));
    -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
            mask-composite: exclude;
    pointer-events: none;
    opacity: .8;
  }
  .nav-gradient {
    background: linear-gradient(110deg, rgba(255,255,255,.55), rgba(226,236,255,.6) 18%, rgba(14,165,233,.25) 42%, rgba(46,106,255,.35) 62%, rgba(255,255,255,.5) 82%);
    background-size: 220% 100%;
    animation: navGradientSlide 16s linear infinite;
  }
  @keyframes navGradientSlide { 0% { background-position: 0% 50%; } 100% { background-position: -200% 50%; } }
  @keyframes blobMoveSlow {
    0%,100% { transform: translate3d(0,0,0) scale(1); }
    33% { transform: translate3d(12px,-8px,0) scale(1.05); }
    66% { transform: translate3d(-10px,10px,0) scale(.95); }
  }
  .animate-blob-slow { animation: blobMoveSlow 22s ease-in-out infinite; }
  .animate-blob-slower { animation: blobMoveSlow 30s ease-in-out infinite reverse; }

  /* Title shimmer */
  @keyframes titleShimmer { 0% { background-position: 0% 50%; } 100% { background-position: 200% 50%; } }
  .animate-title-shimmer { animation: titleShimmer 12s ease-in-out infinite; }

  /* Nav links styling */
  .nav-link { color: #334155; position: relative; }
  .nav-link.is-active { color: #0f3d91; }
  .nav-link .hover-glow {
    position: absolute; inset: 0; border-radius: 9999px; background: radial-gradient(circle at 30% 30%, rgba(46,106,255,.22), rgba(14,165,233,.18), transparent 70%);
    opacity: 0; transform: scale(.6); transition: opacity .4s, transform .45s cubic-bezier(.16,.8,.35,1);
  }
  .nav-link:hover .hover-glow, .nav-link.is-active .hover-glow { opacity: 1; transform: scale(1); }
  .nav-link.is-active { font-weight: 600; }
  .nav-link.is-active::after {
    content: ""; position: absolute; left: 50%; bottom: 4px; width: 36%; height: 2px; background: linear-gradient(90deg,#2E6AFF,#0ea5e9,#1B47A8); border-radius: 2px; transform: translateX(-50%);
  }

  /* CTA button */
  .cta-btn {
    position: relative; display: inline-flex; align-items: center; gap: .5rem; padding: .55rem 1.35rem; border-radius: 9999px;
    background: linear-gradient(95deg,#2E6AFF 0%,#0ea5e9 55%,#1B47A8 100%);
    color: #fff; font-weight: 600; font-size: .85rem; letter-spacing: .25px;
    box-shadow: 0 4px 18px -2px rgba(46,106,255,.35), 0 2px 6px -1px rgba(14,165,233,.25);
    transition: filter .4s, box-shadow .45s, transform .4s;
  }
  .cta-btn::after {
    content: ""; position: absolute; inset: 0; border-radius: inherit; background: linear-gradient(120deg,rgba(255,255,255,.65),rgba(255,255,255,0) 35%,rgba(255,255,255,.55) 70%,rgba(255,255,255,0)); mix-blend-mode: overlay; opacity: .55; pointer-events:none;
  }
  .cta-btn:hover { filter: brightness(1.07) saturate(1.15); box-shadow: 0 5px 22px -2px rgba(46,106,255,.5), 0 3px 10px -1px rgba(14,165,233,.35); }
  .cta-btn:active { transform: translateY(1px); }

  /* Respect reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .nav-gradient, .animate-blob-slow, .animate-blob-slower, .animate-title-shimmer { animation: none !important; background-position: 50% 50% !important; }
  }
</style>
